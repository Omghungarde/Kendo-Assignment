<div class="lead-toolbar">
  <div class="lead-left">
    <h3 class="title">Lead Management</h3>
    <h6 class="subtitle">Leads</h6>
  </div>

  <div class="lead-right">
    <label class="board-checkbox">
      <input type="checkbox" /> Board view
    </label>
    <button class="export-btn" kendoButton type="button" (click)="exportToExcel()">
      <i class="fas fa-download"></i> Export To Excel
    </button>
    <!-- <kendo-excelexport #excelExport [data]="gridItems" fileName="LeadManagementData.xlsx">

      <kendo-excelexport-column field="recordId" title="Record Id"></kendo-excelexport-column>
      <kendo-excelexport-column field="lastName" title="Last Name"></kendo-excelexport-column>
      <kendo-excelexport-column field="firstName" title="First Name"></kendo-excelexport-column>
      <kendo-excelexport-column field="email" title="Email"></kendo-excelexport-column>
      <kendo-excelexport-column field="phoneType" title="Primary Phone Type"></kendo-excelexport-column>
      <kendo-excelexport-column field="leadId" title="LMP Lead ID"></kendo-excelexport-column>
      <kendo-excelexport-column field="appointmentType" title="Appointment Type"></kendo-excelexport-column>
      <kendo-excelexport-column field="bookingAgency" title="Booking Agency"></kendo-excelexport-column>
      <kendo-excelexport-column field="assignedDate" title="Assigned Date"></kendo-excelexport-column>
      <kendo-excelexport-column field="salesRep" title="Sales Rep"></kendo-excelexport-column>
      <kendo-excelexport-column field="coordinator" title="Coordinator"></kendo-excelexport-column>
      <kendo-excelexport-column field="syncToMobile" title="Sync to Mobile"></kendo-excelexport-column>
      <kendo-excelexport-column field="createdSource" title="Created Source"></kendo-excelexport-column>
      <kendo-excelexport-column field="mobileSyncStatus" title="Mobile Sync Status"></kendo-excelexport-column>
      <kendo-excelexport-column field="effectiveDate" title="Effective Date"></kendo-excelexport-column>
      <kendo-excelexport-column field="validThrough" title="Valid Through"></kendo-excelexport-column>

    </kendo-excelexport> -->

    <!-- <button class="create-btn" kendoButton (click)="addNewLead()">Create</button> -->
    <button class="create-btn" kendoButton>Create</button>

  </div>
</div>



<div class="inner">
  <div class="lead-filters">
    <kendo-label>
      <kendo-dropdownlist [data]="listItems" value="All Leads"></kendo-dropdownlist>
    </kendo-label>

    <kendo-label for="preferences-dropdown">
     
      <kendo-dropdownlist
  [data]="savedPreferences"
  [(ngModel)]="selectedPreference"
  (valueChange)="loadSavedState()"
  [valuePrimitive]="true"
>
</kendo-dropdownlist>


    </kendo-label>
    <div class="search-group">
      <kendo-textbox
  [(ngModel)]="searchQuery"
  placeholder="Search..."
  (ngModelChange)="searchGrid()"
>
</kendo-textbox>
    </div>
    <div class="searchbtn">   
      <!-- <button class="search-btn" (click)="onSearchClick(searchBox.value)"> -->
      <button class="search-btn">
        <i class="fas fa-search"></i>
      </button>
      </div>

    <!-- <div class="search-group">
 </div>     <kendo-textbox [style.width.px]="165" placeholder="Search in all columns..."
        (valueChange)="onFilter($event)"></kendo-textbox>
    </div>

    <div class="searchbtn">
      <button class="search-btn">
        <i class="fas fa-search"></i>
      </button>
    </div> -->

    <!-- <div class="custom-pill-toggle">
      <span class="pill-option" [class.active]="!isNonIntl" (click)="isNonIntl = false">
        Intl
      </span>
      <span class="pill-option" [class.active]="isNonIntl" (click)="isNonIntl = true">
        Non-Intl
      </span>
    </div> -->
    <div class="custom-pill-toggle">
      <span class="pill-option">
        Intl
      </span>
      <span class="pill-option">
        Non-Intl
      </span>
    </div>

    <button class="create-btn-div"(click)="clearPreference()">Clear Filters</button>
    <button class="create-btn-div">Bulk Edit</button>
    <button class="create-btn-div"(click)="saveGridSettings(grid)">Save Preference</button>
  </div>
  <kendo-dialog *ngIf="isPreferencePopupOpen" (close)="closePreferencePopup()">
        <div class="popup-content">
          <label for="preferenceInput">Preference Name:</label>
          <input id="preferenceInput" [(ngModel)]="newPreferenceName" />
        </div>
        <kendo-dialog-actions>
          <button kendoButton (click)="saveNewPreference()">Save</button>
          <button kendoButton (click)="closePreferencePopup()">Cancel</button>
        </kendo-dialog-actions>
      </kendo-dialog>

  <kendo-grid
      #grid
      [data]="gridSettings.gridData"
      [resizable]="true"
      [reorderable]="true"
      [columnMenu]="true"
      [pageable]="true"
      [pageSize]="gridSettings.state.take"
      [skip]="gridSettings.state.skip"
      [sortable]="true"
      [sort]="gridSettings.state.sort"
      [filter]="gridSettings.state.filter"
      [group]="gridSettings.state.group"
      (dataStateChange)="dataStateChange($event)"
      (cellClick)="cellClickHandler($event)"
      (dblclick)="onDblClick()"
      (cellClose)="cellCloseHandler($event)"
    >
      @for (col of gridSettings.columnsConfig; track col) {
      <kendo-grid-column
        [field]="col.field"
        [title]="col.title"
        [width]="col.width ?? 100"
        [filter]="col.filter ?? 'text'"
        [filterable]="col.filterable ?? false"
        [hidden]="col.hidden ?? false"
        [format]="col.format"
        [editable]="true"
        (dblclick)="onCellDoubleClick($event)"
      >
      <ng-template kendoGridEditTemplate let-dataItem="dataItem" let-formGroup="formGroup">
        <input
          kendoTextBox
          [formControl]="formGroup.get(col.field)"
          [placeholder]="col.title"
        />
      </ng-template>
      </kendo-grid-column>
      }
    </kendo-grid>

                                              
</div>
                                           
       

<!-- Command Buttons Column -->
    <!-- <kendo-grid-column title="Action Buttons" [width]="250" [sticky]="true">
      <ng-template kendoGridCellTemplate let-dataItem let-rowIndex="rowIndex">
        <ng-container *ngIf="!isItemInEditMode(dataItem)">

          <button class="k-button k-primary ms-2 me-3"
            (click)="editHandler({ sender: grid, rowIndex: rowIndex, dataItem: dataItem })">
            Edit
          </button>
          <button class="k-button k-danger" (click)="removeHandler({ dataItem: dataItem })">
            Remove
          </button>
        </ng-container>
        <ng-container *ngIf="isItemInEditMode(dataItem)">
          <button class="k-button k-success"
            (click)="saveHandler({ sender: grid, rowIndex: rowIndex, formGroup: formGroup })"
            [disabled]="!formGroup.valid">
            Save
          </button>
          <button class="k-button" (click)="cancelHandler({ sender: grid, rowIndex: rowIndex })">
            Cancel
          </button>
        </ng-container>
      </ng-template>
    </kendo-grid-column> -->
                                                                                                                                                                                                                                                                              <!-- <kendo-grid-column field="leadId" title="LMP Lead ID" [width]="150"></kendo-grid-column>
  <kendo-grid-column field="appointmentType" title="Appointment Type" [width]="180"></kendo-grid-column>
  <kendo-grid-column field="bookingAgency" title="Booking Agency" [width]="180"></kendo-grid-column>
  <kendo-grid-column field="assignedDate" title="Assigned Date" filter="date" editor="date" [width]="150"></kendo-grid-column>
  <kendo-grid-column field="salesRep" title="Sales Rep" [width]="150"></kendo-grid-column>
  <kendo-grid-column field="coordinator" title="Coordinator" [width]="150"></kendo-grid-column>

  <kendo-grid-column field="syncToMobile" title="Sync to Mobile" [width]="130">
    <ng-template kendoGridCellTemplate let-dataItem>
      <input type="checkbox" [checked]="dataItem.syncToMobile" disabled />
    </ng-template>
  </kendo-grid-column>

  <kendo-grid-column field="createdSource" title="Created Source" [width]="150"></kendo-grid-column>

  <kendo-grid-column field="mobileSyncStatus" title="Mobile Sync Status" [width]="180">
    <ng-template kendoGridCellTemplate>
      <span class="text-muted">N/A</span>
    </ng-template>
  </kendo-grid-column>

  <kendo-grid-column field="effectiveDate" title="Effective Date" filter="date" editor="date" [width]="150"></kendo-grid-column>
  <kendo-grid-column field="validThrough" title="Valid Through" filter="date" editor="date" [width]="150"></kendo-grid-column> -->
                                                                                                                                                                                                                         